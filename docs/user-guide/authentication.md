# 🔐 사용자 인증 가이드

DINO의 안전한 로그인 및 회원가입 시스템에 대한 완전한 가이드입니다.

## 📋 개요

DINO는 Supabase 인증을 사용하여 안전하고 편리한 로그인 경험을 제공합니다. 모든 사용자 데이터는 개별적으로 보호되며, Row-level Security(RLS)를 통해 다른 사용자의 데이터에 접근할 수 없습니다.

## 🚪 로그인 페이지 접근

### URL
- **개발**: `http://localhost:3000/auth`
- **프로덕션**: `https://dinoapp.net/auth`

### 자동 리다이렉트
- 로그인하지 않은 상태에서 보호된 페이지 접근 시 자동으로 로그인 페이지로 이동
- 이미 로그인된 상태라면 대시보드로 자동 이동

## 📝 회원가입 프로세스

### 1. 이메일 회원가입

#### 단계별 가이드
1. **이메일 입력**
   - 유효한 이메일 주소 입력
   - 예: `nomad@example.com`

2. **비밀번호 설정**
   - 최소 6자리 이상
   - 보안을 위해 복합적인 비밀번호 권장

3. **회원가입 버튼 클릭**
   - 계정이 즉시 생성됨
   - 로그인 상태로 대시보드 이동

#### 이메일 확인 (선택사항)
```
📧 이메일 확인 활성화된 경우:
1. 입력한 이메일로 확인 링크 발송
2. 이메일에서 "Confirm your signup" 클릭
3. 자동으로 대시보드로 이동
```

### 2. OAuth 소셜 로그인

#### 지원되는 제공업체
- **🔵 Google**: Google 계정으로 원클릭 로그인
- **⚫ GitHub**: GitHub 계정으로 개발자 친화적 로그인

#### OAuth 로그인 프로세스
1. **소셜 로그인 버튼 클릭**
   ```
   "Continue with Google" 또는
   "Continue with GitHub" 버튼 클릭
   ```

2. **외부 인증**
   - 선택한 제공업체의 로그인 페이지로 이동
   - 해당 계정으로 로그인 및 권한 승인

3. **자동 계정 연결**
   - DINO 계정이 자동 생성 (첫 로그인 시)
   - 이후 로그인 시 기존 계정 자동 연결

## 🔑 로그인 프로세스

### 기존 사용자 로그인

1. **로그인 정보 입력**
   - 등록된 이메일 주소
   - 설정한 비밀번호

2. **로그인 실행**
   - "Sign In" 버튼 클릭
   - OAuth 제공업체 선택 (소셜 로그인 시)

3. **자동 리다이렉트**
   - 성공 시 대시보드로 이동
   - 기존 로컬스토리지 데이터 자동 마이그레이션

### 자동 로그인 유지
```
🔄 세션 관리:
- 브라우저 쿠키를 통한 자동 로그인
- 세션 토큰 자동 갱신
- 안전한 로그아웃까지 로그인 상태 유지
```

## 📱 로그인 페이지 UI 구성

### 헤더 섹션
```
🌍 DINO
Digital Nomad Visa Tracker
Track your visa status across countries
```

### 인증 폼
- **깔끔한 화이트 카드** 디자인
- **Supabase Auth UI** 컴포넌트 사용
- **파란색 브랜드** 색상 (`#2563eb`)

### 반응형 디자인
- **모바일**: 전체 화면 최적화
- **태블릿**: 중앙 정렬 카드
- **데스크톱**: 최대 너비 제한 (`max-w-md`)

## 🔒 보안 기능

### 데이터 보호
- **암호화**: 모든 비밀번호 해시 암호화
- **HTTPS**: 모든 통신 SSL/TLS 암호화
- **토큰 기반**: JWT 토큰 인증
- **RLS**: 사용자별 데이터 격리

### 세션 관리
```typescript
// 자동 토큰 갱신
auth: {
  autoRefreshToken: true,
  persistSession: true,
}
```

### 보안 정책
- **비밀번호**: 최소 6자리 요구
- **세션 타임아웃**: 자동 갱신으로 무제한
- **브루트포스 방지**: Supabase 내장 보호

## 🔄 계정 관리

### 로그아웃
1. **대시보드에서 로그아웃**
   - 사용자명 옆 "로그아웃" 클릭
   - 즉시 로그인 페이지로 이동

2. **자동 세션 정리**
   - 로컬 토큰 제거
   - 서버 세션 무효화

### 계정 복구
```
🔄 비밀번호 재설정:
1. 로그인 페이지에서 "Forgot your password?" 클릭
2. 이메일 주소 입력
3. 이메일로 받은 링크로 새 비밀번호 설정
```

## 📊 데이터 마이그레이션

### 로컬스토리지 자동 마이그레이션
```typescript
// 첫 로그인 시 자동 실행
migrateFromLocalStorage().then(() => {
  loadStays() // 클라우드에서 데이터 로드
})
```

### 마이그레이션 프로세스
1. **로컬 데이터 확인**: 브라우저 localStorage 검사
2. **중복 확인**: 이미 클라우드 데이터가 있는지 확인
3. **자동 업로드**: 로컬 데이터를 안전하게 클라우드로 이전
4. **정리**: 마이그레이션 후 로컬 데이터 삭제

## ⚠️ 문제 해결

### 일반적인 오류

#### "Invalid credentials" 오류
```
🔧 해결 방법:
1. 이메일 주소 정확성 확인
2. 비밀번호 대소문자 확인
3. 비밀번호 재설정 시도
```

#### 이메일 확인 필요
```
📧 확인 프로세스:
1. 스팸 폴더 확인
2. 확인 이메일 재발송 요청
3. 다른 이메일 주소로 재시도
```

#### OAuth 로그인 실패
```
🔄 OAuth 문제:
1. 팝업 차단 해제
2. 브라우저 쿠키 허용
3. 다른 브라우저로 시도
```

### 네트워크 오류
```
🌐 연결 문제:
- 인터넷 연결 상태 확인
- VPN 사용 시 일시적 해제
- 방화벽 설정 확인
```

## 🎯 사용 팁

### 최적의 로그인 경험
1. **브라우저 저장**: "비밀번호 저장" 허용으로 편의성 증대
2. **OAuth 권장**: 소셜 로그인으로 더 빠른 접근
3. **모바일 북마크**: 홈화면에 바로가기 추가

### 보안 권장사항
1. **강력한 비밀번호**: 8자리 이상, 특수문자 포함
2. **정기적 로그아웃**: 공용 컴퓨터 사용 후
3. **계정 모니터링**: 비정상적 활동 시 즉시 신고

---

**다음 단계**: [📊 대시보드 사용법](./dashboard.md)으로 메인 기능을 알아보세요.